(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     78680,       1963]
NotebookOptionsPosition[     75505,       1920]
NotebookOutlinePosition[     75838,       1935]
CellTagsIndexPosition[     75795,       1932]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 StyleBox["Notebook for the polynomial method in the Dirac-Weyl equation. \n",
   "Title"],
 StyleBox["This example is for the case of the zigzag-like hexagonal graphene \
flake, but it can be modified to suit other systems/boundary conditions. ", 
  "Subtitle"]
}], "Input",
 CellChangeTimes->{{3.785258852764806*^9, 3.785258869501403*^9}, {
  3.7852589032856894`*^9, 3.785258964479085*^9}, {3.785259248112681*^9, 
  3.785259256302013*^9}},ExpressionUUID->"fb8e752b-9328-4db8-96b4-\
2d48ec51f856"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{
   "Silencing", " ", "the", " ", "\"\<evaluation is zero\>\"", " ", "warning",
     " ", "messages"}], ";"}], "Text",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{
  3.785258833274914*^9, {3.785259883769573*^9, 3.785259885007958*^9}, {
   3.785259958612564*^9, 3.7852599888094397`*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"519beb74-def1-46f1-80e1-cae1fd945658"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ParallelEvaluate", "[", 
    RowBox[{
     RowBox[{"Off", "[", 
      RowBox[{"NIntegrate", "::", "ncvb"}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Off", "[", 
      RowBox[{"NIntegrate", "::", "slwcon"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Off", "[", 
      RowBox[{"NIntegrate", "::", "eincr"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Off", "[", 
      RowBox[{"NIntegrate", "::", "oidiv"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Off", "[", 
      RowBox[{"NIntegrate", "::", "izero"}], "]"}], ";"}], "]"}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{
  3.785258833274914*^9, {3.785259883769573*^9, 3.785259885007958*^9}, {
   3.785259958612564*^9, 3.785259963270611*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"951033f6-d344-4ea3-b80f-ea908db2a50f"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   StyleBox[
    RowBox[{
     StyleBox[
      StyleBox[
       StyleBox["Defining", "Text",
        FontWeight->"Bold"], "Text",
       FontWeight->"Bold"], "Text",
      FontWeight->"Bold"], " ", 
     StyleBox[
      StyleBox[
       StyleBox["physical", "Text",
        FontWeight->"Bold"], "Text",
       FontWeight->"Bold"], "Text",
      FontWeight->"Bold"], " ", 
     StyleBox[
      StyleBox[
       StyleBox["constants", "Text",
        FontWeight->"Bold"], "Text",
       FontWeight->"Bold"], "Text",
      FontWeight->"Bold"], " ", 
     StyleBox[
      StyleBox[
       StyleBox["and", "Text",
        FontWeight->"Bold"], "Text",
       FontWeight->"Bold"], "Text",
      FontWeight->"Bold"], " ", 
     StyleBox[
      StyleBox[
       StyleBox["stuff", "Text",
        FontWeight->"Bold"], "Text",
       FontWeight->"Bold"], "Text",
      FontWeight->"Bold"]}], "Text",
    FontWeight->"Bold"], ";"}], "Text",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{
  3.785258049477735*^9, {3.785258842132854*^9, 3.785258842312882*^9}, {
   3.7852598926993713`*^9, 3.785259894336547*^9}, {3.785259937460724*^9, 
   3.785259994239748*^9}},ExpressionUUID->"b7acc9f9-f25a-408c-bebd-\
251042706f15"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[HBar]", "=", "1."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vf", "=", "1."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", "=", "1."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sqrt3", "=", 
   RowBox[{"N", "[", 
    SqrtBox["3"], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sparseIdentityMatrix", "[", "n_", "]"}], " ", ":=", " ", 
  RowBox[{"SparseArray", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"i_", ",", " ", "i_"}], "}"}], "\[Rule]", "1"}], "}"}], ",", 
    " ", 
    RowBox[{"{", 
     RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"id", "=", 
   RowBox[{"sparseIdentityMatrix", "[", "2", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"size", "=", "6."}], ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.785258049477735*^9, {3.785258842132854*^9, 3.785258842312882*^9}, {
   3.7852598926993713`*^9, 3.785259894336547*^9}, {3.785259937460724*^9, 
   3.7852599712384167`*^9}, 3.785260257702194*^9, {3.785260377951117*^9, 
   3.785260426790539*^9}, {3.785261061000554*^9, 3.785261061540574*^9}, 
   3.785433729527931*^9},
 CellLabel->"In[2]:=",ExpressionUUID->"b66c53cb-f962-4987-8863-3afd3d75aa9b"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   StyleBox[
    RowBox[{"Creating", " ", "data", " ", "folder"}], "Text",
    FontWeight->"Bold"], ";"}], "Text",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.7852305302090197`*^9, 3.7852305304160337`*^9}, {
   3.78523631989699*^9, 3.785236346106791*^9}, {3.785237000355133*^9, 
   3.785237005852515*^9}, {3.785237294846365*^9, 3.785237310608473*^9}, {
   3.7852414971594887`*^9, 3.785241497625482*^9}, {3.785258203530286*^9, 
   3.785258265334046*^9}, {3.785258298913094*^9, 3.785258309730977*^9}, 
   3.785259058541662*^9, {3.785259900963957*^9, 3.785259902462387*^9}, 
   3.7852599334149113`*^9, {3.78525999598622*^9, 
   3.7852600024238167`*^9}},ExpressionUUID->"a1bd13b8-dd7d-4e52-8cbf-\
1c9cdd92b143"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"shape", "=", "\"\<hexagon\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"boundary", "=", "\"\<zigzag\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"folder", "=", 
   RowBox[{
   "\"\<~/agr_tese/data/helmholtz/\>\"", "<>", "shape", "<>", "\"\<_\>\"", "<>",
     "boundary", "<>", "\"\<_\>\""}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"basissize", "=", 
   RowBox[{"ToString", "[", 
    RowBox[{"Floor", "[", "size", "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CreateDirectory", "[", 
    RowBox[{"folder", "<>", "basissize"}], "]"}], "//", "Quiet"}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7852305302090197`*^9, 3.7852305304160337`*^9}, {
   3.78523631989699*^9, 3.785236346106791*^9}, {3.785237000355133*^9, 
   3.785237005852515*^9}, {3.785237294846365*^9, 3.785237310608473*^9}, {
   3.7852414971594887`*^9, 3.785241497625482*^9}, {3.785258203530286*^9, 
   3.785258265334046*^9}, {3.785258298913094*^9, 3.785258309730977*^9}, 
   3.785259058541662*^9, {3.785259900963957*^9, 3.785259902462387*^9}, 
   3.7852599334149113`*^9, {3.78525999598622*^9, 3.7852600024238167`*^9}, 
   3.785260259432575*^9, {3.7854343176867857`*^9, 3.7854343269982147`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"5452c035-7b03-4be5-9cf2-83a401ece3dc"],

Cell[BoxData[{
 RowBox[{
  StyleBox[
   StyleBox[
    RowBox[{"Defining", " ", "the", " ", "billiard", " ", "region"}], "Text"],
   
   FontWeight->"Bold"], 
  StyleBox[";", "Text"]}], "\[IndentingNewLine]", 
 StyleBox[
  StyleBox[
   RowBox[{
    StyleBox[
     RowBox[{
      RowBox[{
      "The", " ", "region", " ", "plot", " ", "is", " ", "just", " ", "to", 
       " ", "double", " ", "check", " ", "if", " ", "the", " ", "boundaries", 
       " ", "are", " ", "well"}], "-", "defined"}],
     FontWeight->"Bold"], ";"}], "Text"],
  FontWeight->"Bold"]}], "Input",
 CellChangeTimes->{{3.785258071304981*^9, 3.78525810102623*^9}, {
  3.7852588026388206`*^9, 3.785258802958085*^9}, {3.785259315713099*^9, 
  3.785259340604303*^9}, {3.78525990765604*^9, 3.7852599268854427`*^9}, {
  3.7852600070570517`*^9, 
  3.785260016655665*^9}},ExpressionUUID->"067d5e9f-1210-4493-a2b3-\
58bb44696a25"],

Cell[BoxData[{
 RowBox[{"RegionPlot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "L"}], "+", 
      FractionBox[
       RowBox[{"RealAbs", "[", "y", "]"}], "sqrt3"]}], "\[LessEqual]", "x", 
     "\[LessEqual]", 
     RowBox[{"L", "-", 
      FractionBox[
       RowBox[{"RealAbs", "[", "y", "]"}], "sqrt3"]}]}], "&&", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["sqrt3", "2"]}], "*", "L"}], "\[LessEqual]", "y", 
     "\[LessEqual]", 
     RowBox[{
      FractionBox["sqrt3", "2"], "*", "L"}]}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"-", "L"}], ",", "L"}], "}"}], " ", ",", 
   RowBox[{"{", 
    RowBox[{"y", ",", 
     RowBox[{"-", "L"}], ",", "L"}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"reg", "=", 
   RowBox[{"Polygon", "[", 
    RowBox[{"CirclePoints", "[", 
     RowBox[{"L", ",", "6"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.785258071304981*^9, 3.78525810102623*^9}, {
   3.7852588026388206`*^9, 3.785258802958085*^9}, {3.785259315713099*^9, 
   3.785259340604303*^9}, {3.78525990765604*^9, 3.7852599268854427`*^9}, {
   3.7852600070570517`*^9, 3.785260016655665*^9}, 3.785260270936514*^9, {
   3.785260397163216*^9, 3.785260397721435*^9}, {3.785260433130351*^9, 
   3.7852604385815487`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"ba5f509b-9c46-4ba8-b3d6-c9ae274610fd"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   StyleBox[
    RowBox[{"Defining", " ", "the", " ", "scalar", " ", "product"}], "Text"], 
   
   StyleBox[",", "Text"], 
   StyleBox[" ", "Text"], 
   StyleBox[
    RowBox[{"the", " ", "norm"}], "Text"], 
   StyleBox[",", "Text"], 
   StyleBox[" ", "Text"], 
   RowBox[{
    StyleBox[
     RowBox[{
     "and", " ", "the", " ", "Hamiltonian", " ", "matrix", " ", "element"}], 
     "Text"], ";"}]}],
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.785258721897181*^9, 3.7852587221634808`*^9}, {
  3.7852593607229557`*^9, 3.785259371605946*^9}, {3.7852600214146223`*^9, 
  3.785260035936859*^9}},ExpressionUUID->"ccb35278-6677-4fff-b66f-\
621be0e79bfa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MyNorm", "[", "func1_", "]"}], ":=", 
  RowBox[{"\[Sqrt]", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Conjugate", "[", 
       RowBox[{"func1", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "]"}], ".", 
      RowBox[{"func1", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["sqrt3", "2"]}], "*", "L"}], ",", 
       RowBox[{
        FractionBox["sqrt3", "2"], "*", "L"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{
        RowBox[{"-", "L"}], "+", 
        FractionBox[
         RowBox[{"RealAbs", "[", "y", "]"}], "sqrt3"]}], ",", 
       RowBox[{"L", "-", 
        FractionBox[
         RowBox[{"RealAbs", "[", "y", "]"}], "sqrt3"]}]}], "}"}], ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<LocalAdaptive\>\"", ",", 
        RowBox[{"Method", "\[Rule]", "\"\<LobattoKronrodRule\>\""}], ",", 
        RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0.0001"}]}], 
       "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyNormSc", "[", "func1_", "]"}], ":=", 
  RowBox[{"\[Sqrt]", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Conjugate", "[", 
       RowBox[{"func1", "[", 
        RowBox[{"x", ",", "y"}], "]"}], "]"}], "*", 
      RowBox[{"func1", "[", 
       RowBox[{"x", ",", "y"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["sqrt3", "2"]}], "*", "L"}], ",", 
       RowBox[{
        FractionBox["sqrt3", "2"], "*", "L"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{
        RowBox[{"-", "L"}], "+", 
        FractionBox[
         RowBox[{"RealAbs", "[", "y", "]"}], "sqrt3"]}], ",", 
       RowBox[{"L", "-", 
        FractionBox[
         RowBox[{"RealAbs", "[", "y", "]"}], "sqrt3"]}]}], "}"}], ",", 
     RowBox[{"Method", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<LocalAdaptive\>\"", ",", 
        RowBox[{"Method", "\[Rule]", "\"\<LobattoKronrodRule\>\""}], ",", 
        RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0.0001"}]}], 
       "}"}]}]}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyProd", "[", 
   RowBox[{"func1_", ",", "func2_"}], "]"}], ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Conjugate", "[", 
      RowBox[{"func1", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "]"}], ".", 
     RowBox[{"func2", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["sqrt3", "2"]}], "*", "L"}], ",", 
      RowBox[{
       FractionBox["sqrt3", "2"], "*", "L"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{"-", "L"}], "+", 
       FractionBox[
        RowBox[{"RealAbs", "[", "y", "]"}], "sqrt3"]}], ",", 
      RowBox[{"L", "-", 
       FractionBox[
        RowBox[{"RealAbs", "[", "y", "]"}], "sqrt3"]}]}], "}"}], ",", 
    RowBox[{"Method", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<LocalAdaptive\>\"", ",", 
       RowBox[{"Method", "\[Rule]", "\"\<LobattoKronrodRule\>\""}], ",", 
       RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0.0001"}]}], 
      "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MyProdSc", "[", 
   RowBox[{"func1_", ",", "func2_"}], "]"}], ":=", 
  RowBox[{"NIntegrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Conjugate", "[", 
      RowBox[{"func1", "[", 
       RowBox[{"x", ",", "y"}], "]"}], "]"}], "*", 
     RowBox[{"func2", "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{
       RowBox[{"-", 
        FractionBox["sqrt3", "2"]}], "*", "L"}], ",", 
      RowBox[{
       FractionBox["sqrt3", "2"], "*", "L"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{
       RowBox[{"-", "L"}], "+", 
       FractionBox[
        RowBox[{"RealAbs", "[", "y", "]"}], "sqrt3"]}], ",", 
      RowBox[{"L", "-", 
       FractionBox[
        RowBox[{"RealAbs", "[", "y", "]"}], "sqrt3"]}]}], "}"}], ",", 
    RowBox[{"Method", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"\"\<LocalAdaptive\>\"", ",", 
       RowBox[{"Method", "\[Rule]", "\"\<LobattoKronrodRule\>\""}], ",", 
       RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0.0001"}]}], 
      "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"En", "[", 
   RowBox[{"f1_", ",", "f2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"-", "\[HBar]"}], "*", "vf", "*", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"Chop", "[", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"Conjugate", "[", 
           RowBox[{"f1", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "]"}], ".", "id", ".", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"f2", "[", 
             RowBox[{"x", ",", "y"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "2"}], "}"}]}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["sqrt3", "2"]}], "*", "L"}], ",", 
         RowBox[{
          FractionBox["sqrt3", "2"], "*", "L"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{
          RowBox[{"-", "L"}], "+", 
          FractionBox[
           RowBox[{"RealAbs", "[", "y", "]"}], "sqrt3"]}], ",", 
         RowBox[{"L", "-", 
          FractionBox[
           RowBox[{"RealAbs", "[", "y", "]"}], "sqrt3"]}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<LocalAdaptive\>\"", ",", 
          RowBox[{"Method", "\[Rule]", "\"\<LobattoKronrodRule\>\""}], ",", 
          RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0.0001"}]}], 
         "}"}]}], ",", 
       RowBox[{"AccuracyGoal", "\[Rule]", "8"}], ",", 
       RowBox[{"PrecisionGoal", "\[Rule]", "7"}]}], "]"}]}], "]"}], "+", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"-", "\[HBar]"}], "*", "vf", "*", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"Chop", "[", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"Conjugate", "[", 
           RowBox[{"f1", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "]"}], ".", "id", ".", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"f2", "[", 
             RowBox[{"x", ",", "y"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["sqrt3", "2"]}], "*", "L"}], ",", 
         RowBox[{
          FractionBox["sqrt3", "2"], "*", "L"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{
          RowBox[{"-", "L"}], "+", 
          FractionBox[
           RowBox[{"RealAbs", "[", "y", "]"}], "sqrt3"]}], ",", 
         RowBox[{"L", "-", 
          FractionBox[
           RowBox[{"RealAbs", "[", "y", "]"}], "sqrt3"]}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<LocalAdaptive\>\"", ",", 
          RowBox[{"Method", "\[Rule]", "\"\<LobattoKronrodRule\>\""}], ",", 
          RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0.0001"}]}], 
         "}"}]}], ",", 
       RowBox[{"AccuracyGoal", "\[Rule]", "8"}], ",", 
       RowBox[{"PrecisionGoal", "\[Rule]", "7"}]}], "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EnSc", "[", 
   RowBox[{"f1_", ",", "f2_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"-", "\[HBar]"}], "*", "vf", "*", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"Chop", "[", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"Conjugate", "[", 
           RowBox[{"f1", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "]"}], "*", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"f2", "[", 
             RowBox[{"x", ",", "y"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "2"}], "}"}]}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["sqrt3", "2"]}], "*", "L"}], ",", 
         RowBox[{
          FractionBox["sqrt3", "2"], "*", "L"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{
          RowBox[{"-", "L"}], "+", 
          FractionBox[
           RowBox[{"RealAbs", "[", "y", "]"}], "sqrt3"]}], ",", 
         RowBox[{"L", "-", 
          FractionBox[
           RowBox[{"RealAbs", "[", "y", "]"}], "sqrt3"]}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<LocalAdaptive\>\"", ",", 
          RowBox[{"Method", "\[Rule]", "\"\<LobattoKronrodRule\>\""}], ",", 
          RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0.0001"}]}], 
         "}"}]}], ",", 
       RowBox[{"AccuracyGoal", "\[Rule]", "8"}], ",", 
       RowBox[{"PrecisionGoal", "\[Rule]", "7"}]}], "]"}]}], "]"}], "+", 
   RowBox[{"Chop", "[", 
    RowBox[{
     RowBox[{"-", "\[HBar]"}], "*", "vf", "*", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{"Chop", "[", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"Conjugate", "[", 
           RowBox[{"f1", "[", 
            RowBox[{"x", ",", "y"}], "]"}], "]"}], "*", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"f2", "[", 
             RowBox[{"x", ",", "y"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "2"}], "}"}]}], "]"}]}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["sqrt3", "2"]}], "*", "L"}], ",", 
         RowBox[{
          FractionBox["sqrt3", "2"], "*", "L"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{
          RowBox[{"-", "L"}], "+", 
          FractionBox[
           RowBox[{"RealAbs", "[", "y", "]"}], "sqrt3"]}], ",", 
         RowBox[{"L", "-", 
          FractionBox[
           RowBox[{"RealAbs", "[", "y", "]"}], "sqrt3"]}]}], "}"}], ",", 
       RowBox[{"Method", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<LocalAdaptive\>\"", ",", 
          RowBox[{"Method", "\[Rule]", "\"\<LobattoKronrodRule\>\""}], ",", 
          RowBox[{"\"\<SymbolicProcessing\>\"", "\[Rule]", "0.0001"}]}], 
         "}"}]}], ",", 
       RowBox[{"AccuracyGoal", "\[Rule]", "8"}], ",", 
       RowBox[{"PrecisionGoal", "\[Rule]", "7"}]}], "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.785258721897181*^9, 3.7852587221634808`*^9}, {
   3.7852593607229557`*^9, 3.785259371605946*^9}, {3.7852600214146223`*^9, 
   3.785260035936859*^9}, 3.785260265963694*^9, {3.785260445838377*^9, 
   3.7852604671957083`*^9}, {3.7854337573972073`*^9, 3.785433757811666*^9}, {
   3.7854337892910013`*^9, 3.785433867139111*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"8f88d0a3-a0e8-44e9-8e7c-86d0640a2fac"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{
   "Define", " ", "the", " ", "initial", " ", "functions", " ", "here"}], 
   ";"}], "Text",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.785258135181431*^9, 3.785258135576799*^9}, {
   3.785258316686874*^9, 3.785258327984872*^9}, 3.785258362781151*^9, {
   3.785258708401312*^9, 3.785258763998454*^9}, {3.7852594147157516`*^9, 
   3.785259442016677*^9}, 3.785259491283615*^9, {3.785260041521346*^9, 
   3.785260049236888*^9}},ExpressionUUID->"3ff692bd-7b5f-4ce0-9d11-\
a48c23067cda"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]u", "[", 
    RowBox[{"1", ",", "x_", ",", "y_"}], "]"}], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"sqrt3", "*", "L"}], ")"}], "/", "2"}], "+", "y"}], ")"}], 
      "*", 
      RowBox[{"(", 
       RowBox[{"L", "+", 
        RowBox[{"(", 
         RowBox[{"x", "-", 
          RowBox[{"y", "/", "sqrt3"}]}], ")"}]}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"L", "-", 
        RowBox[{"(", 
         RowBox[{"x", "+", 
          RowBox[{"y", "/", "sqrt3"}]}], ")"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"sqrt3", "*", " ", "L"}], ")"}], "/", "2"}], "-", "y"}], 
       ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"L", "-", 
        RowBox[{"(", 
         RowBox[{"x", "-", 
          RowBox[{"y", "/", "sqrt3"}]}], ")"}]}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"L", "+", 
        RowBox[{"(", 
         RowBox[{"x", "+", 
          RowBox[{"y", "/", "sqrt3"}]}], ")"}]}], ")"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]un", "[", 
    RowBox[{"1", ",", "x_", ",", "y_"}], "]"}], "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"MyNorm", "[", 
          RowBox[{
           RowBox[{"\[Psi]u", "[", 
            RowBox[{"1", ",", "#1", ",", "#2"}], "]"}], "&"}], "]"}], ")"}]}],
        ")"}], 
      RowBox[{"\[Psi]u", "[", 
       RowBox[{"1", ",", "x", ",", "y"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]un", "[", 
   RowBox[{"1", ",", "x", ",", "y"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"En", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]un", "[", 
      RowBox[{"1", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
    RowBox[{
     RowBox[{"\[Psi]un", "[", 
      RowBox[{"1", ",", "#1", ",", "#2"}], "]"}], "&"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]Au", "[", 
    RowBox[{"1", ",", "x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", "3", "]"}], " ", "L"}], ")"}], "/", "2"}], "+", 
      "y"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{"L", "+", 
      RowBox[{"(", 
       RowBox[{"x", "-", 
        RowBox[{"y", "/", 
         RowBox[{"Sqrt", "[", "3", "]"}]}]}], ")"}]}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{"L", "-", 
      RowBox[{"(", 
       RowBox[{"x", "+", 
        RowBox[{"y", "/", 
         RowBox[{"Sqrt", "[", "3", "]"}]}]}], ")"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]Aun", "[", 
    RowBox[{"1", ",", "x_", ",", "y_"}], "]"}], "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"MyNormSc", "[", 
          RowBox[{
           RowBox[{"\[Psi]Au", "[", 
            RowBox[{"1", ",", "#1", ",", "#2"}], "]"}], "&"}], "]"}], ")"}]}],
        ")"}], 
      RowBox[{"\[Psi]Au", "[", 
       RowBox[{"1", ",", "x", ",", "y"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]Aun", "[", 
   RowBox[{"1", ",", "x", ",", "y"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"EnSc", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Psi]Aun", "[", 
      RowBox[{"1", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
    RowBox[{
     RowBox[{"\[Psi]Aun", "[", 
      RowBox[{"1", ",", "#1", ",", "#2"}], "]"}], "&"}]}], "]"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]Bu", "[", 
    RowBox[{"1", ",", "x_", ",", "y_"}], "]"}], "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sqrt", "[", "3", "]"}], " ", "L"}], ")"}], "/", "2"}], "-", 
      "y"}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{"L", "-", 
      RowBox[{"(", 
       RowBox[{"x", "-", 
        RowBox[{"y", "/", 
         RowBox[{"Sqrt", "[", "3", "]"}]}]}], ")"}]}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{"L", "+", 
      RowBox[{"(", 
       RowBox[{"x", "+", 
        RowBox[{"y", "/", 
         RowBox[{"Sqrt", "[", "3", "]"}]}]}], ")"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Psi]Bun", "[", 
    RowBox[{"1", ",", "x_", ",", "y_"}], "]"}], "=", 
   RowBox[{"Chop", "[", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", 
        RowBox[{"(", 
         RowBox[{"MyNormSc", "[", 
          RowBox[{
           RowBox[{"\[Psi]Bu", "[", 
            RowBox[{"1", ",", "#1", ",", "#2"}], "]"}], "&"}], "]"}], ")"}]}],
        ")"}], 
      RowBox[{"\[Psi]Bu", "[", 
       RowBox[{"1", ",", "x", ",", "y"}], "]"}]}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]Bun", "[", 
   RowBox[{"1", ",", "x", ",", "y"}], "]"}], "//", 
  "MatrixForm"}], "\[IndentingNewLine]", 
 RowBox[{"EnSc", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Psi]Bun", "[", 
     RowBox[{"1", ",", "#1", ",", "#2"}], "]"}], "&"}], ",", 
   RowBox[{
    RowBox[{"\[Psi]Bun", "[", 
     RowBox[{"1", ",", "#1", ",", "#2"}], "]"}], "&"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.785258135181431*^9, 3.785258135576799*^9}, {
   3.785258316686874*^9, 3.785258327984872*^9}, 3.785258362781151*^9, {
   3.785258708401312*^9, 3.785258763998454*^9}, {3.7852594147157516`*^9, 
   3.785259442016677*^9}, 3.785259491283615*^9, {3.785260041521346*^9, 
   3.785260049236888*^9}, 3.785260268107338*^9, {3.785260638904937*^9, 
   3.7852606583864803`*^9}, {3.785260698311504*^9, 3.78526072263361*^9}, {
   3.785433914949849*^9, 3.785433928133617*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"918f50e8-50c3-4b79-bb1f-e78b9ff0b347"],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   StyleBox[
    RowBox[{"Gram", "-", 
     RowBox[{"Schmidt", " ", "Process", " ", "for", " ", "2"}], "-", 
     RowBox[{"band", " ", "models"}]}], "Text",
    FontWeight->"Bold"], ";"}], "Text",
  FontWeight->"Bold"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   StyleBox[
    RowBox[{
     StyleBox["This", "Text",
      FontWeight->"Bold"], " ", 
     StyleBox["defines", "Text",
      FontWeight->"Bold"], " ", 
     StyleBox["the", "Text",
      FontWeight->"Bold"], " ", 
     StyleBox["Basis", "Text",
      FontWeight->"Bold"], " ", 
     StyleBox["object", "Text",
      FontWeight->"Bold"]}], "Text",
    FontWeight->"Bold"], ";"}], "Text",
  FontWeight->"Bold"]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQA2IQfcxCgWGt/hvHhS33lEF08HoBTRCdwjldB0RfWzff
AES/4TxlBaLXc1rZg+hTldfDQXT778oEEF3y2zMVRG+usWwA0ezV0U0geuWr
qh6wvpwmMG2QenACiNYJubcYRAtkX1wJouvSX+0G0V/Yzx0F0TduzjwGohW2
fzkNonuKNK+D6Cn+wfdAtEox9yMQLWL29zOI/rC17CuIDkva+RtEL6ma8A9E
NxSt5lwHpO/JfgTTHkvUlED0hc4qFRD9r89q5kYgbTIlHEy7nO5efc74jaNY
vOY2EP0pZuN1EG3y4+oNEL3D+HHmeSDNwhiSDaJdhO26QPSp2VvB9NI9PX1g
8W6diSAaAFZutm4=
  "],
 CellLabel->"In[66]:=",ExpressionUUID->"a733a13d-861e-44ed-84f1-9ba32eb31045"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", 
    RowBox[{"m_", ",", "x_", ",", "y_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Floor", "[", 
            SqrtBox[
             RowBox[{"m", "-", "1"}]], "]"}], ")"}], "2"]}], ",", "2"}], 
       "]"}], "==", "0"}], ",", 
     RowBox[{
      SuperscriptBox["x", 
       RowBox[{"Floor", "[", 
        SqrtBox[
         RowBox[{"m", "-", "1"}]], "]"}]], "*", 
      SuperscriptBox["y", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Floor", "[", 
            SqrtBox[
             RowBox[{"m", "-", "1"}]], "]"}], ")"}], "2"]}], "2"]]}], ",", 
     RowBox[{
      SuperscriptBox["x", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"m", "-", "1"}], ")"}], "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"Floor", "[", 
            SqrtBox[
             RowBox[{"m", "-", "1"}]], "]"}], ")"}], "2"], "-", "1"}], "2"]], 
      "*", 
      SuperscriptBox["y", 
       RowBox[{"Floor", "[", 
        SqrtBox[
         RowBox[{"m", "-", "1"}]], "]"}]]}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"m", "=", "2"}], ",", 
     RowBox[{"m", "<", 
      RowBox[{"size", "+", "1"}]}], ",", 
     RowBox[{"m", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Psi]u", "[", 
        RowBox[{"m", ",", "x_", ",", "y_"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"m", ",", "x", ",", "y"}], "]"}], "*", 
         RowBox[{"\[Psi]un", "[", 
          RowBox[{"1", ",", "x", ",", "y"}], "]"}]}], "-", 
        RowBox[{"ParallelSum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MyProd", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"m", ",", "#1", ",", "#2"}], "]"}], "*", 
               RowBox[{"\[Psi]un", "[", 
                RowBox[{"1", ",", "#1", ",", "#2"}], "]"}]}], "&"}], ",", 
             RowBox[{
              RowBox[{"\[Psi]un", "[", 
               RowBox[{"n", ",", "#1", ",", "#2"}], "]"}], "&"}]}], "]"}], 
           "*", 
           RowBox[{"\[Psi]un", "[", 
            RowBox[{"n", ",", "x", ",", "y"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1", ",", 
            RowBox[{"m", "-", "1"}]}], "}"}], ",", 
          RowBox[{"Method", "\[Rule]", "\"\<CoarsestGrained\>\""}], ",", 
          RowBox[{"DistributedContexts", "\[Rule]", "Automatic"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Psi]un", "[", 
        RowBox[{"m", ",", "x_", ",", "y_"}], "]"}], "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"Simplify", "[", 
         FractionBox[
          RowBox[{"\[Psi]u", "[", 
           RowBox[{"m", ",", "x", ",", "y"}], "]"}], 
          RowBox[{"MyNorm", "[", 
           RowBox[{
            RowBox[{"\[Psi]u", "[", 
             RowBox[{"m", ",", "#1", ",", "#2"}], "]"}], "&"}], "]"}]], "]"}],
         "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "m", "]"}]}]}], "]"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"mA", "=", "2"}], ",", 
     RowBox[{"mA", "<", 
      RowBox[{"size", "+", "1"}]}], ",", 
     RowBox[{"mA", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Psi]Au", "[", 
        RowBox[{"mA", ",", "x_", ",", "y_"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"mA", ",", "x", ",", "y"}], "]"}], "*", 
         RowBox[{"\[Psi]Aun", "[", 
          RowBox[{"1", ",", "x", ",", "y"}], "]"}]}], "-", 
        RowBox[{"ParallelSum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MyProdSc", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"mA", ",", "#1", ",", "#2"}], "]"}], "*", 
               RowBox[{"\[Psi]Aun", "[", 
                RowBox[{"1", ",", "#1", ",", "#2"}], "]"}]}], "&"}], ",", 
             RowBox[{
              RowBox[{"\[Psi]Aun", "[", 
               RowBox[{"nA", ",", "#1", ",", "#2"}], "]"}], "&"}]}], "]"}], 
           "*", 
           RowBox[{"\[Psi]Aun", "[", 
            RowBox[{"nA", ",", "x", ",", "y"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"nA", ",", "1", ",", 
            RowBox[{"mA", "-", "1"}]}], "}"}], ",", 
          RowBox[{"Method", "\[Rule]", "\"\<CoarsestGrained\>\""}], ",", 
          RowBox[{"DistributedContexts", "\[Rule]", "Automatic"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Psi]Aun", "[", 
        RowBox[{"mA", ",", "x_", ",", "y_"}], "]"}], "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"Simplify", "[", 
         FractionBox[
          RowBox[{"\[Psi]Au", "[", 
           RowBox[{"mA", ",", "x", ",", "y"}], "]"}], 
          RowBox[{"MyNormSc", "[", 
           RowBox[{
            RowBox[{"\[Psi]Au", "[", 
             RowBox[{"mA", ",", "#1", ",", "#2"}], "]"}], "&"}], "]"}]], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "mA", "]"}]}]}], "]"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"mB", "=", "2"}], ",", 
     RowBox[{"mB", "<", 
      RowBox[{"size", "+", "1"}]}], ",", 
     RowBox[{"mB", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Psi]Bu", "[", 
        RowBox[{"mB", ",", "x_", ",", "y_"}], "]"}], "=", 
       RowBox[{
        RowBox[{
         RowBox[{"f", "[", 
          RowBox[{"mB", ",", "x", ",", "y"}], "]"}], "*", 
         RowBox[{"\[Psi]Bun", "[", 
          RowBox[{"1", ",", "x", ",", "y"}], "]"}]}], "-", 
        RowBox[{"ParallelSum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MyProdSc", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"f", "[", 
                RowBox[{"mB", ",", "#1", ",", "#2"}], "]"}], "*", 
               RowBox[{"\[Psi]Bun", "[", 
                RowBox[{"1", ",", "#1", ",", "#2"}], "]"}]}], "&"}], ",", 
             RowBox[{
              RowBox[{"\[Psi]Bun", "[", 
               RowBox[{"nB", ",", "#1", ",", "#2"}], "]"}], "&"}]}], "]"}], 
           "*", 
           RowBox[{"\[Psi]Bun", "[", 
            RowBox[{"nB", ",", "x", ",", "y"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"nB", ",", "1", ",", 
            RowBox[{"mB", "-", "1"}]}], "}"}], ",", 
          RowBox[{"Method", "\[Rule]", "\"\<CoarsestGrained\>\""}], ",", 
          RowBox[{"DistributedContexts", "\[Rule]", "Automatic"}]}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"\[Psi]Bun", "[", 
        RowBox[{"mB", ",", "x_", ",", "y_"}], "]"}], "=", 
       RowBox[{"Chop", "[", 
        RowBox[{"Simplify", "[", 
         FractionBox[
          RowBox[{"\[Psi]Bu", "[", 
           RowBox[{"mB", ",", "x", ",", "y"}], "]"}], 
          RowBox[{"MyNormSc", "[", 
           RowBox[{
            RowBox[{"\[Psi]Bu", "[", 
             RowBox[{"mB", ",", "#1", ",", "#2"}], "]"}], "&"}], "]"}]], 
         "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "mB", "]"}]}]}], "]"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Basis", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\[Psi]un", "[", 
      RowBox[{"i", ",", "x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BasisA", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\[Psi]Aun", "[", 
      RowBox[{"i", ",", "x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BasisB", "[", 
    RowBox[{"x_", ",", "y_"}], "]"}], "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"\[Psi]Bun", "[", 
      RowBox[{"i", ",", "x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "size"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", 
  RowBox[{"Basis", "[", 
   RowBox[{"x", ",", "y"}], "]"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7830922250069304`*^9, 3.78309251095369*^9}, {
   3.783092552521402*^9, 3.7830925807198963`*^9}, {3.7830926129900923`*^9, 
   3.783092694313711*^9}, {3.783092729813682*^9, 3.783092926733617*^9}, {
   3.783092995811954*^9, 3.783093034311945*^9}, {3.783093249796472*^9, 
   3.783093266858768*^9}, {3.783093347841145*^9, 3.783093348075767*^9}, {
   3.783093382043602*^9, 3.783093534947775*^9}, {3.783093582544319*^9, 
   3.7830937273251333`*^9}, {3.783093806438471*^9, 3.7830938128078423`*^9}, {
   3.783093855647354*^9, 3.783093945295233*^9}, {3.783094002603464*^9, 
   3.7830940323578053`*^9}, {3.7830941759128513`*^9, 3.783094187709709*^9}, {
   3.783094237793254*^9, 3.783094260514971*^9}, {3.783094349357727*^9, 
   3.783094351534896*^9}, {3.783094545207554*^9, 3.783094563829323*^9}, {
   3.783101641829955*^9, 3.783101642736841*^9}, {3.7852583323685627`*^9, 
   3.785258417292857*^9}, {3.785258685542596*^9, 3.785258694686548*^9}, {
   3.7852598551000633`*^9, 3.785259866625124*^9}, 3.7852601139398518`*^9, 
   3.785260278705537*^9, {3.785260753254554*^9, 3.7852607855070333`*^9}, {
   3.78543396447438*^9, 3.785434002677353*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"1350be2a-d688-4bf9-a263-45943594805a"],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
    StyleBox["Uncomment", "Text"], 
    StyleBox[" ", "Text"], 
    StyleBox["this", "Text"], 
    StyleBox[" ", "Text"], 
    StyleBox["table", "Text"], 
    StyleBox[" ", "Text"], 
    StyleBox["if", "Text"], 
    StyleBox[" ", "Text"], 
    StyleBox["you", "Text"], 
    StyleBox[" ", "Text"], 
    StyleBox["want", "Text"], 
    StyleBox[" ", "Text"], 
    StyleBox["to", "Text"], 
    StyleBox[" ", "Text"], 
    StyleBox["see", "Text"], 
    StyleBox[" ", "Text"], "check", " ", "the", " ", "orthogonality", " ", 
    "of", " ", "the", " ", "basis"}], ";"}],
  FontWeight->"Bold"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   StyleBox[
    RowBox[{
    "This", " ", "matrix", " ", "will", " ", "take", " ", "a", " ", "very", 
     " ", "long", " ", "time", " ", "to", " ", "calculate"}], "Text"], 
   StyleBox[",", "Text"], 
   StyleBox[" ", "Text"], 
   RowBox[{
    StyleBox[
     RowBox[{
      RowBox[{"as", " ", "it", " ", "has", " ", "all", " ", "off"}], "-", 
      RowBox[{
      "diagonal", " ", "terms", " ", "equal", " ", "to", " ", "zero"}]}], 
     "Text"], ";"}]}],
  FontWeight->"Bold"]}], "Input",
 CellChangeTimes->{{3.785258609681336*^9, 3.7852586413406477`*^9}, {
  3.785260310797842*^9, 3.785260312695166*^9}, {3.785260922159594*^9, 
  3.785261105506968*^9}, {3.785261185543725*^9, 
  3.785261195178358*^9}},ExpressionUUID->"7c13dc57-460f-46e1-87a6-\
9ffa1d4d0d1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"ortho", "=", 
           RowBox[{"ParallelTable", "[", 
            RowBox[{
             RowBox[{"MyProd", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Basis", "[", 
                  RowBox[{"#1", ",", "#2"}], "]"}], "[", 
                 RowBox[{"[", "b", "]"}], "]"}], "&"}], ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Basis", "[", 
                  RowBox[{"#1", ",", "#2"}], "]"}], "[", 
                 RowBox[{"[", "c", "]"}], "]"}], "&"}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"b", ",", "1", ",", 
               RowBox[{"2", "*", "size"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"c", ",", "1", ",", "i"}], "}"}], ",", 
             RowBox[{"Method", "\[Rule]", "\"\<FinestGrained\>\""}], ",", 
             RowBox[{"DistributedContexts", "\[Rule]", "Automatic"}]}], 
            "]"}]}], ";"}], "//", 
         RowBox[{"AbsoluteTiming", "\[IndentingNewLine]", "orthofull"}]}], 
        "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{"Join", ",", 
          RowBox[{"{", 
           RowBox[{"ortho", ",", 
            RowBox[{"Rest", "/@", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"Conjugate", "[", "ortho", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"{", "2", "}"}], ",", 
                 RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}]}], "}"}]}], 
         "]"}]}], ";"}], "]"}], "\[IndentingNewLine]", 
     RowBox[{"MatrixForm", "[", "orthofull", "]"}]}], "//", "Chop"}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.785258609681336*^9, 3.7852586413406477`*^9}, {
  3.785260310797842*^9, 3.785260312695166*^9}, {3.785260922159594*^9, 
  3.785261105506968*^9}, {3.785261185543725*^9, 
  3.785261195178358*^9}},ExpressionUUID->"20adb904-f5da-475f-b421-\
f0c293bec05e"],

Cell[BoxData[{
 StyleBox[
  RowBox[{
   RowBox[{
   "The", " ", "Hamiltonian", " ", "matrix", " ", "with", " ", "this", " ", 
    "basis"}], " ", ";"}], "Text",
  FontWeight->"Bold"], "\[IndentingNewLine]", 
 StyleBox[
  RowBox[{
   StyleBox[
    RowBox[{
     StyleBox["As", "Text",
      FontWeight->"Bold"], " ", 
     StyleBox["this", "Text",
      FontWeight->"Bold"], " ", 
     StyleBox["matrix", "Text",
      FontWeight->"Bold"], " ", 
     StyleBox["is", "Text",
      FontWeight->"Bold"], " ", 
     StyleBox["Hermitian", "Text",
      FontWeight->"Bold"]}], "Text",
    FontWeight->"Bold"], 
   StyleBox[",", "Text",
    FontWeight->"Bold"], 
   StyleBox[" ", "Text",
    FontWeight->"Bold"], 
   RowBox[{
    RowBox[{
     StyleBox["we", "Text",
      FontWeight->"Bold"], " ", 
     StyleBox["can", "Text",
      FontWeight->"Bold"], " ", 
     StyleBox["calculate", "Text",
      FontWeight->"Bold"], " ", 
     StyleBox["only", "Text",
      FontWeight->"Bold"], " ", 
     StyleBox["the", "Text",
      FontWeight->"Bold"], " ", 
     StyleBox["upper", "Text",
      FontWeight->"Bold"], " ", 
     StyleBox["triangular", "Text",
      FontWeight->"Bold"], " ", 
     StyleBox["matrix", "Text",
      FontWeight->"Bold"]}], 
    StyleBox[" ", "Text",
     FontWeight->"Bold"], ";"}]}], "Text",
  FontWeight->"Bold"]}], "Input",
 CellChangeTimes->{{3.770467393772599*^9, 3.770467488885778*^9}, {
   3.770470127208796*^9, 3.770470130000372*^9}, {3.770470169695065*^9, 
   3.770470172382001*^9}, {3.770471709542108*^9, 3.770471711751409*^9}, {
   3.770476561773738*^9, 3.770476562160201*^9}, {3.770489683959461*^9, 
   3.7704896888596067`*^9}, {3.770490403333658*^9, 3.770490406320606*^9}, {
   3.770490686322816*^9, 3.770490710078915*^9}, {3.770505779167287*^9, 
   3.77050586019339*^9}, {3.770516570204129*^9, 3.770516573427815*^9}, {
   3.770516719628394*^9, 3.770516720156764*^9}, {3.770516923476111*^9, 
   3.770516931059256*^9}, 3.770517209855348*^9, 3.7705172451902027`*^9, {
   3.7705181966984453`*^9, 3.770518204813324*^9}, {3.770518410821473*^9, 
   3.7705184677838697`*^9}, {3.770518510625312*^9, 3.770518516304698*^9}, {
   3.770529268850008*^9, 3.770529272149887*^9}, {3.770532493426591*^9, 
   3.7705325068703136`*^9}, {3.7705325483372*^9, 3.770532556663843*^9}, {
   3.7705444988359957`*^9, 3.770544502273397*^9}, {3.770551609547164*^9, 
   3.770551611358885*^9}, {3.770551659968669*^9, 3.7705516635965357`*^9}, {
   3.770568401329661*^9, 3.770568403788365*^9}, {3.770612564171977*^9, 
   3.770612570520578*^9}, {3.770716704978857*^9, 3.77071670775455*^9}, {
   3.7707174063335943`*^9, 3.770717407864366*^9}, {3.770718561198839*^9, 
   3.7707185625885897`*^9}, {3.7707187022529593`*^9, 3.770718703379189*^9}, {
   3.770719840897684*^9, 3.770719842138857*^9}, {3.7708760628323793`*^9, 
   3.770876066760789*^9}, {3.77098892647371*^9, 3.770988934466331*^9}, {
   3.7709902228224287`*^9, 3.770990223541046*^9}, {3.771053552022039*^9, 
   3.771053554621112*^9}, {3.771067648727157*^9, 3.771067652812935*^9}, {
   3.771154521438408*^9, 3.77115452613582*^9}, {3.771154640822381*^9, 
   3.771154643564414*^9}, {3.771154737714588*^9, 3.77115475424403*^9}, {
   3.771163210529882*^9, 3.771163249715008*^9}, {3.771163580084423*^9, 
   3.77116359083707*^9}, {3.771163645558209*^9, 3.7711636533144217`*^9}, {
   3.771171695158174*^9, 3.771171702494073*^9}, {3.771173242074815*^9, 
   3.771173246968606*^9}, {3.771314015112989*^9, 3.771314023278796*^9}, {
   3.772456727429325*^9, 3.772456735168313*^9}, {3.772544843115827*^9, 
   3.7725448480387087`*^9}, {3.772969671953431*^9, 3.7729696763895903`*^9}, {
   3.773142327524344*^9, 3.773142345090333*^9}, {3.773142409846929*^9, 
   3.7731424259663973`*^9}, 3.773142483845738*^9, {3.7731426450502253`*^9, 
   3.773142677040447*^9}, 3.77366100343049*^9, {3.782914960538973*^9, 
   3.782914966184267*^9}, 3.78299543696815*^9, {3.783022267173648*^9, 
   3.7830222684169064`*^9}, {3.785241581360902*^9, 3.785241582116544*^9}, {
   3.785258162777672*^9, 3.785258163075053*^9}, {3.7852584366895123`*^9, 
   3.785258459274541*^9}, {3.785259836088883*^9, 3.785259848328188*^9}, {
   3.785260177020549*^9, 
   3.785260187817574*^9}},ExpressionUUID->"cfc621a4-70b5-4860-b6e1-\
6eb13c8ca592"],

Cell[BoxData[{
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"H", "=", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"En", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Basis", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"Basis", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}], "&"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "size"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "i"}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<CoarsestGrained\>\""}], ",", 
      RowBox[{"DistributedContexts", "\[Rule]", "Automatic"}]}], "]"}]}], 
   ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"Hfull", "=", 
    RowBox[{"MapThread", "[", 
     RowBox[{"Join", ",", 
      RowBox[{"{", 
       RowBox[{"H", ",", 
        RowBox[{"Rest", "/@", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Conjugate", "[", "H", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "2", "}"}], ",", 
             RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}]}], "}"}]}], "]"}]}], 
   ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "Hfull", "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"HA", "=", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"EnSc", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"BasisA", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"BasisA", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}], "&"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "size"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "i"}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<CoarsestGrained\>\""}], ",", 
      RowBox[{"DistributedContexts", "\[Rule]", "Automatic"}]}], "]"}]}], 
   ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"HAfull", "=", 
    RowBox[{"MapThread", "[", 
     RowBox[{"Join", ",", 
      RowBox[{"{", 
       RowBox[{"HA", ",", 
        RowBox[{"Rest", "/@", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Conjugate", "[", "HA", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "2", "}"}], ",", 
             RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}]}], "}"}]}], "]"}]}], 
   ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "HAfull", "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"HB", "=", 
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"EnSc", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"BasisB", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], "[", 
          RowBox[{"[", "i", "]"}], "]"}], "&"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"BasisB", "[", 
           RowBox[{"#1", ",", "#2"}], "]"}], "[", 
          RowBox[{"[", "j", "]"}], "]"}], "&"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "size"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "i"}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<CoarsestGrained\>\""}], ",", 
      RowBox[{"DistributedContexts", "\[Rule]", "Automatic"}]}], "]"}]}], 
   ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{"HBfull", "=", 
    RowBox[{"MapThread", "[", 
     RowBox[{"Join", ",", 
      RowBox[{"{", 
       RowBox[{"HB", ",", 
        RowBox[{"Rest", "/@", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Conjugate", "[", "HB", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "2", "}"}], ",", 
             RowBox[{"{", "1", "}"}]}], "}"}]}], "]"}]}]}], "}"}]}], "]"}]}], 
   ";"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "HBfull", "]"}], "\[IndentingNewLine]"}], "Input",\

 CellChangeTimes->{{3.770467393772599*^9, 3.770467488885778*^9}, {
   3.770470127208796*^9, 3.770470130000372*^9}, {3.770470169695065*^9, 
   3.770470172382001*^9}, {3.770471709542108*^9, 3.770471711751409*^9}, {
   3.770476561773738*^9, 3.770476562160201*^9}, {3.770489683959461*^9, 
   3.7704896888596067`*^9}, {3.770490403333658*^9, 3.770490406320606*^9}, {
   3.770490686322816*^9, 3.770490710078915*^9}, {3.770505779167287*^9, 
   3.77050586019339*^9}, {3.770516570204129*^9, 3.770516573427815*^9}, {
   3.770516719628394*^9, 3.770516720156764*^9}, {3.770516923476111*^9, 
   3.770516931059256*^9}, 3.770517209855348*^9, 3.7705172451902027`*^9, {
   3.7705181966984453`*^9, 3.770518204813324*^9}, {3.770518410821473*^9, 
   3.7705184677838697`*^9}, {3.770518510625312*^9, 3.770518516304698*^9}, {
   3.770529268850008*^9, 3.770529272149887*^9}, {3.770532493426591*^9, 
   3.7705325068703136`*^9}, {3.7705325483372*^9, 3.770532556663843*^9}, {
   3.7705444988359957`*^9, 3.770544502273397*^9}, {3.770551609547164*^9, 
   3.770551611358885*^9}, {3.770551659968669*^9, 3.7705516635965357`*^9}, {
   3.770568401329661*^9, 3.770568403788365*^9}, {3.770612564171977*^9, 
   3.770612570520578*^9}, {3.770716704978857*^9, 3.77071670775455*^9}, {
   3.7707174063335943`*^9, 3.770717407864366*^9}, {3.770718561198839*^9, 
   3.7707185625885897`*^9}, {3.7707187022529593`*^9, 3.770718703379189*^9}, {
   3.770719840897684*^9, 3.770719842138857*^9}, {3.7708760628323793`*^9, 
   3.770876066760789*^9}, {3.77098892647371*^9, 3.770988934466331*^9}, {
   3.7709902228224287`*^9, 3.770990223541046*^9}, {3.771053552022039*^9, 
   3.771053554621112*^9}, {3.771067648727157*^9, 3.771067652812935*^9}, {
   3.771154521438408*^9, 3.77115452613582*^9}, {3.771154640822381*^9, 
   3.771154643564414*^9}, {3.771154737714588*^9, 3.77115475424403*^9}, {
   3.771163210529882*^9, 3.771163249715008*^9}, {3.771163580084423*^9, 
   3.77116359083707*^9}, {3.771163645558209*^9, 3.7711636533144217`*^9}, {
   3.771171695158174*^9, 3.771171702494073*^9}, {3.771173242074815*^9, 
   3.771173246968606*^9}, {3.771314015112989*^9, 3.771314023278796*^9}, {
   3.772456727429325*^9, 3.772456735168313*^9}, {3.772544843115827*^9, 
   3.7725448480387087`*^9}, {3.772969671953431*^9, 3.7729696763895903`*^9}, {
   3.773142327524344*^9, 3.773142345090333*^9}, {3.773142409846929*^9, 
   3.7731424259663973`*^9}, 3.773142483845738*^9, {3.7731426450502253`*^9, 
   3.773142677040447*^9}, 3.77366100343049*^9, {3.782914960538973*^9, 
   3.782914966184267*^9}, 3.78299543696815*^9, {3.783022267173648*^9, 
   3.7830222684169064`*^9}, {3.785241581360902*^9, 3.785241582116544*^9}, {
   3.785258162777672*^9, 3.785258163075053*^9}, {3.7852584366895123`*^9, 
   3.785258459274541*^9}, {3.785259836088883*^9, 3.785259848328188*^9}, {
   3.785260177020549*^9, 3.78526019358604*^9}, 3.785260280194882*^9, {
   3.7854340222818336`*^9, 3.785434052945944*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"4c8bc942-ff59-4901-aa5a-b7da44c8835a"],

Cell[BoxData[
 StyleBox[
  RowBox[{"Also", ",", " ", 
   RowBox[{
    RowBox[{"eigenvalues", " ", "and", " ", "eigenvectors"}], ";"}]}], "Text",
  
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.770467393772599*^9, 3.770467488885778*^9}, {
   3.770470127208796*^9, 3.770470130000372*^9}, {3.770470169695065*^9, 
   3.770470172382001*^9}, {3.770471709542108*^9, 3.770471711751409*^9}, {
   3.770476561773738*^9, 3.770476562160201*^9}, {3.770489683959461*^9, 
   3.7704896888596067`*^9}, {3.770490403333658*^9, 3.770490406320606*^9}, {
   3.770490686322816*^9, 3.770490710078915*^9}, {3.770505779167287*^9, 
   3.77050586019339*^9}, {3.770516570204129*^9, 3.770516573427815*^9}, {
   3.770516719628394*^9, 3.770516720156764*^9}, {3.770516923476111*^9, 
   3.770516931059256*^9}, 3.770517209855348*^9, 3.7705172451902027`*^9, {
   3.7705181966984453`*^9, 3.770518204813324*^9}, {3.770518410821473*^9, 
   3.7705184677838697`*^9}, {3.770518510625312*^9, 3.770518516304698*^9}, {
   3.770529268850008*^9, 3.770529272149887*^9}, {3.770532493426591*^9, 
   3.7705325068703136`*^9}, {3.7705325483372*^9, 3.770532556663843*^9}, {
   3.7705444988359957`*^9, 3.770544502273397*^9}, {3.770551609547164*^9, 
   3.770551611358885*^9}, {3.770551659968669*^9, 3.7705516635965357`*^9}, {
   3.770568401329661*^9, 3.770568403788365*^9}, {3.770612564171977*^9, 
   3.770612570520578*^9}, {3.770716704978857*^9, 3.77071670775455*^9}, {
   3.7707174063335943`*^9, 3.770717407864366*^9}, {3.770718561198839*^9, 
   3.7707185625885897`*^9}, {3.7707187022529593`*^9, 3.770718703379189*^9}, {
   3.770719840897684*^9, 3.770719842138857*^9}, {3.7708760628323793`*^9, 
   3.770876066760789*^9}, {3.77098892647371*^9, 3.770988934466331*^9}, {
   3.7709902228224287`*^9, 3.770990223541046*^9}, {3.771053552022039*^9, 
   3.771053554621112*^9}, {3.771067648727157*^9, 3.771067652812935*^9}, {
   3.771154521438408*^9, 3.77115452613582*^9}, {3.771154640822381*^9, 
   3.771154643564414*^9}, {3.771154737714588*^9, 3.77115475424403*^9}, {
   3.771163210529882*^9, 3.771163249715008*^9}, {3.771163580084423*^9, 
   3.77116359083707*^9}, {3.771163645558209*^9, 3.7711636533144217`*^9}, {
   3.771171695158174*^9, 3.771171702494073*^9}, {3.771173242074815*^9, 
   3.771173246968606*^9}, {3.771314015112989*^9, 3.771314023278796*^9}, {
   3.772456727429325*^9, 3.772456735168313*^9}, {3.772544843115827*^9, 
   3.7725448480387087`*^9}, {3.772969671953431*^9, 3.7729696763895903`*^9}, {
   3.773142327524344*^9, 3.773142345090333*^9}, {3.773142409846929*^9, 
   3.7731424259663973`*^9}, 3.773142483845738*^9, {3.7731426450502253`*^9, 
   3.773142677040447*^9}, 3.77366100343049*^9, {3.782914960538973*^9, 
   3.782914966184267*^9}, 3.78299543696815*^9, {3.783022267173648*^9, 
   3.7830222684169064`*^9}, {3.785241581360902*^9, 3.785241582116544*^9}, {
   3.785258162777672*^9, 3.785258163075053*^9}, {3.7852584366895123`*^9, 
   3.785258459274541*^9}, {3.785259836088883*^9, 3.785259848328188*^9}, {
   3.785260177020549*^9, 
   3.785260205233127*^9}},ExpressionUUID->"a94ffc03-4ce5-44b9-ad6c-\
51980a746ffe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eval", "=", 
   RowBox[{"Eigenvalues", "[", "Hfull", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evalA", "=", 
   RowBox[{"Eigenvalues", "[", "HAfull", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"evalB", "=", 
    RowBox[{"Eigenvalues", "[", "HBfull", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"evec", "=", 
   RowBox[{"Eigenvectors", "[", "Hfull", "]"}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.770467393772599*^9, 3.770467488885778*^9}, {
   3.770470127208796*^9, 3.770470130000372*^9}, {3.770470169695065*^9, 
   3.770470172382001*^9}, {3.770471709542108*^9, 3.770471711751409*^9}, {
   3.770476561773738*^9, 3.770476562160201*^9}, {3.770489683959461*^9, 
   3.7704896888596067`*^9}, {3.770490403333658*^9, 3.770490406320606*^9}, {
   3.770490686322816*^9, 3.770490710078915*^9}, {3.770505779167287*^9, 
   3.77050586019339*^9}, {3.770516570204129*^9, 3.770516573427815*^9}, {
   3.770516719628394*^9, 3.770516720156764*^9}, {3.770516923476111*^9, 
   3.770516931059256*^9}, 3.770517209855348*^9, 3.7705172451902027`*^9, {
   3.7705181966984453`*^9, 3.770518204813324*^9}, {3.770518410821473*^9, 
   3.7705184677838697`*^9}, {3.770518510625312*^9, 3.770518516304698*^9}, {
   3.770529268850008*^9, 3.770529272149887*^9}, {3.770532493426591*^9, 
   3.7705325068703136`*^9}, {3.7705325483372*^9, 3.770532556663843*^9}, {
   3.7705444988359957`*^9, 3.770544502273397*^9}, {3.770551609547164*^9, 
   3.770551611358885*^9}, {3.770551659968669*^9, 3.7705516635965357`*^9}, {
   3.770568401329661*^9, 3.770568403788365*^9}, {3.770612564171977*^9, 
   3.770612570520578*^9}, {3.770716704978857*^9, 3.77071670775455*^9}, {
   3.7707174063335943`*^9, 3.770717407864366*^9}, {3.770718561198839*^9, 
   3.7707185625885897`*^9}, {3.7707187022529593`*^9, 3.770718703379189*^9}, {
   3.770719840897684*^9, 3.770719842138857*^9}, {3.7708760628323793`*^9, 
   3.770876066760789*^9}, {3.77098892647371*^9, 3.770988934466331*^9}, {
   3.7709902228224287`*^9, 3.770990223541046*^9}, {3.771053552022039*^9, 
   3.771053554621112*^9}, {3.771067648727157*^9, 3.771067652812935*^9}, {
   3.771154521438408*^9, 3.77115452613582*^9}, {3.771154640822381*^9, 
   3.771154643564414*^9}, {3.771154737714588*^9, 3.77115475424403*^9}, {
   3.771163210529882*^9, 3.771163249715008*^9}, {3.771163580084423*^9, 
   3.77116359083707*^9}, {3.771163645558209*^9, 3.7711636533144217`*^9}, {
   3.771171695158174*^9, 3.771171702494073*^9}, {3.771173242074815*^9, 
   3.771173246968606*^9}, {3.771314015112989*^9, 3.771314023278796*^9}, {
   3.772456727429325*^9, 3.772456735168313*^9}, {3.772544843115827*^9, 
   3.7725448480387087`*^9}, {3.772969671953431*^9, 3.7729696763895903`*^9}, {
   3.773142327524344*^9, 3.773142345090333*^9}, {3.773142409846929*^9, 
   3.7731424259663973`*^9}, 3.773142483845738*^9, {3.7731426450502253`*^9, 
   3.773142677040447*^9}, 3.77366100343049*^9, {3.782914960538973*^9, 
   3.782914966184267*^9}, 3.78299543696815*^9, {3.783022267173648*^9, 
   3.7830222684169064`*^9}, {3.785241581360902*^9, 3.785241582116544*^9}, {
   3.785258162777672*^9, 3.785258163075053*^9}, {3.7852584366895123`*^9, 
   3.785258459274541*^9}, {3.785259836088883*^9, 3.785259848328188*^9}, {
   3.785260177020549*^9, 3.785260197091392*^9}, 3.7852602815882883`*^9, {
   3.785434027132209*^9, 3.785434037178134*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"438bd73c-4649-49b3-95a9-7c91dde8d978"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"Plotting", " ", "the", " ", "eigenvalues"}], ";"}], "Text",
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.785258471944813*^9, 3.785258475013237*^9}, {
  3.785260208607189*^9, 
  3.785260220325005*^9}},ExpressionUUID->"72576364-7689-48fd-9daa-\
acf25d5191e3"],

Cell[BoxData[{
 SqrtBox[
  RowBox[{"Sort", "[", 
   RowBox[{"Abs", "[", "eval", "]"}], "]"}]], "\[IndentingNewLine]", 
 RowBox[{"ListPlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SqrtBox[
      RowBox[{"Sort", "[", 
       RowBox[{"Abs", "[", "evalA", "]"}], "]"}]], ",", 
     SqrtBox[
      RowBox[{"Sort", "[", 
       RowBox[{"Abs", "[", "evalB", "]"}], "]"}]], ",", 
     SqrtBox[
      RowBox[{"Sort", "[", 
       RowBox[{"Abs", "[", "eval", "]"}], "]"}]]}], "}"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", "Large"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.785258471944813*^9, 3.785258475013237*^9}, {
   3.785260208607189*^9, 3.785260220325005*^9}, 3.785260282839114*^9, {
   3.785434079128324*^9, 3.785434083616281*^9}, {3.785434123551229*^9, 
   3.785434156863278*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"4a99885c-7290-4c62-a783-e6b98ce1853e"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   StyleBox[
    RowBox[{
    "Defining", " ", "the", " ", "eigenbasis", " ", "for", " ", "this", " ", 
     "basis"}], "Text"], ";"}],
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.785258179334035*^9, 3.785258179754278*^9}, {
  3.7852584775771227`*^9, 3.785258490132372*^9}, {3.7852602227324944`*^9, 
  3.7852602356226473`*^9}},ExpressionUUID->"f1403115-c119-4ca2-8c7e-\
3a071d99b407"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"i", "=", "1"}], ",", 
     RowBox[{"i", "<", 
      RowBox[{"size", "+", "1"}]}], ",", 
     RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"mode", "[", 
        RowBox[{"i", ",", "x_", ",", "y_"}], "]"}], "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"evec", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ")"}], ".", 
        RowBox[{"Basis", "[", 
         RowBox[{"x", ",", "y"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"modeN", "[", 
        RowBox[{"i", ",", "x_", ",", "y_"}], "]"}], "=", 
       FractionBox[
        RowBox[{"mode", "[", 
         RowBox[{"i", ",", "x", ",", "y"}], "]"}], 
        RowBox[{"MyNorm", "[", 
         RowBox[{
          RowBox[{"mode", "[", 
           RowBox[{"i", ",", "#1", ",", "#2"}], "]"}], "&"}], "]"}]]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", "i", "]"}]}]}], "]"}], "//", "AbsoluteTiming"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.785258179334035*^9, 3.785258179754278*^9}, {
   3.7852584775771227`*^9, 3.785258490132372*^9}, {3.7852602227324944`*^9, 
   3.7852602356226473`*^9}, 3.7852602850418787`*^9, 3.7854341726015368`*^9},
 CellLabel->"In[59]:=",ExpressionUUID->"cb6a44ab-92b7-4ee1-9482-2e7a55215e8a"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   StyleBox[
    RowBox[{
    "Checking", " ", "if", " ", "the", " ", "results", " ", "match", " ", 
     "with", " ", "one", " ", "another"}], "Text"], ";"}],
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.783084722488792*^9, 3.7830847618918877`*^9}, {
   3.7830848112981443`*^9, 3.783084912513809*^9}, {3.783084993678746*^9, 
   3.7830850129669313`*^9}, {3.7830857262043753`*^9, 3.783085819075604*^9}, 
   3.783088023195181*^9, {3.78309503494825*^9, 3.783095042365787*^9}, 
   3.785241553791252*^9, {3.785258493043497*^9, 3.785258546308175*^9}, {
   3.7852602383907337`*^9, 
   3.7852602473451033`*^9}},ExpressionUUID->"442387ef-7edc-4d12-8030-\
2a3fedd767e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ListPlot", "[", 
   RowBox[{"{", 
    RowBox[{
     SqrtBox[
      RowBox[{"Sort", "[", 
       RowBox[{"Abs", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Chop", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Conjugate", "[", "evec", "]"}], ".", "Hfull", ".", 
              RowBox[{"Transpose", "[", "evec", "]"}]}], ")"}], "[", 
            RowBox[{"[", 
             RowBox[{"f", ",", "f"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"f", ",", "1", ",", "size"}], "}"}]}], "]"}], "]"}], 
       "]"}]], ",", 
     SqrtBox[
      RowBox[{"Sort", "[", 
       RowBox[{"Abs", "[", "eval", "]"}], "]"}]]}], "}"}], "]"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.783084722488792*^9, 3.7830847618918877`*^9}, {
   3.7830848112981443`*^9, 3.783084912513809*^9}, {3.783084993678746*^9, 
   3.7830850129669313`*^9}, {3.7830857262043753`*^9, 3.783085819075604*^9}, 
   3.783088023195181*^9, {3.78309503494825*^9, 3.783095042365787*^9}, 
   3.785241553791252*^9, {3.785258493043497*^9, 3.785258546308175*^9}, {
   3.7852602383907337`*^9, 3.7852602473451033`*^9}, 3.785260286919331*^9, {
   3.785434182057644*^9, 3.78543418221528*^9}, {3.785434280578103*^9, 
   3.785434295813596*^9}},ExpressionUUID->"8c07614c-395a-4240-995b-\
7411e6957ada"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   StyleBox["Finally", "Text"], 
   StyleBox[",", "Text"], 
   StyleBox[" ", "Text"], 
   RowBox[{
    StyleBox[
     RowBox[{
     "exporting", " ", "the", " ", "data", " ", "to", " ", "the", " ", 
      "created", " ", "location"}], "Text"], ";"}]}],
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.785228266414277*^9, 3.785228271915456*^9}, {
   3.785228358754323*^9, 3.785228519897077*^9}, {3.785228554988371*^9, 
   3.785228567299176*^9}, {3.785228634720503*^9, 3.7852286608096952`*^9}, {
   3.785228787819676*^9, 3.785228811616952*^9}, {3.785228952253428*^9, 
   3.7852289925393057`*^9}, {3.785229107982832*^9, 3.785229122834578*^9}, {
   3.7852292576506863`*^9, 3.7852292586734877`*^9}, {3.785229292196467*^9, 
   3.785229374506669*^9}, {3.785230112921163*^9, 3.785230163998402*^9}, {
   3.785230365258803*^9, 3.7852304180080338`*^9}, {3.785230453795751*^9, 
   3.7852304725350113`*^9}, {3.785230512280375*^9, 3.785230532272604*^9}, {
   3.785236385502645*^9, 3.7852363881029453`*^9}, {3.7852364396780567`*^9, 
   3.785236443112397*^9}, {3.785237331251534*^9, 3.785237368160993*^9}, {
   3.785237494514159*^9, 3.785237505004903*^9}, {3.7852375635429773`*^9, 
   3.785237573737165*^9}, {3.7852377799759903`*^9, 3.7852377858905687`*^9}, {
   3.785241328583473*^9, 3.785241339781232*^9}, 3.785241428934774*^9, {
   3.785241490835868*^9, 3.785241491124919*^9}, {3.785258554193006*^9, 
   3.7852585860296783`*^9}, {3.785260290240576*^9, 
   3.7852603044376173`*^9}},ExpressionUUID->"dade93fb-e65b-43dd-a80c-\
f30f9842394e"],

Cell[BoxData[{
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"folder", "<>", "basissize", "<>", "\"\</eigenvalues.dat\>\""}], 
   ",", 
   RowBox[{"Append", "[", 
    RowBox[{
     SqrtBox[
      RowBox[{"Sort", "[", 
       RowBox[{"Abs", "[", "eval", "]"}], "]"}]], ","}], "]"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"folder", "<>", "basissize", "<>", "\"\</basis_A.m\>\""}], ",", 
   RowBox[{"BasisA", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"folder", "<>", "basissize", "<>", "\"\</basis_B.m\>\""}], ",", 
   RowBox[{"BasisB", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"folder", "<>", "basissize", "<>", "\"\</basis.m\>\""}], ",", 
   RowBox[{"Basis", "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"folder", "<>", "basissize", "<>", "\"\</eigenvectors.m\>\""}], 
   ",", "evec"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "folder", "<>", "basissize", "<>", "\"\</full_hamiltonian_A.m\>\""}], ",", 
   "HAfull"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{
   "folder", "<>", "basissize", "<>", "\"\</full_hamiltonian_B.m\>\""}], ",", 
   "HBfull"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"folder", "<>", "basissize", "<>", "\"\</full_hamiltonian.m\>\""}],
    ",", "Hfull"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"Export", "[", 
  RowBox[{
   RowBox[{"folder", "<>", "basissize", "<>", "\"\</eigenfunctions.m\>\""}], 
   ",", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"modeN", "[", 
      RowBox[{"aa", ",", "x", ",", "y"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"aa", ",", "1", ",", "size"}], "}"}]}], "]"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.785228266414277*^9, 3.785228271915456*^9}, {
   3.785228358754323*^9, 3.785228519897077*^9}, {3.785228554988371*^9, 
   3.785228567299176*^9}, {3.785228634720503*^9, 3.7852286608096952`*^9}, {
   3.785228787819676*^9, 3.785228811616952*^9}, {3.785228952253428*^9, 
   3.7852289925393057`*^9}, {3.785229107982832*^9, 3.785229122834578*^9}, {
   3.7852292576506863`*^9, 3.7852292586734877`*^9}, {3.785229292196467*^9, 
   3.785229374506669*^9}, {3.785230112921163*^9, 3.785230163998402*^9}, {
   3.785230365258803*^9, 3.7852304180080338`*^9}, {3.785230453795751*^9, 
   3.7852304725350113`*^9}, {3.785230512280375*^9, 3.785230532272604*^9}, {
   3.785236385502645*^9, 3.7852363881029453`*^9}, {3.7852364396780567`*^9, 
   3.785236443112397*^9}, {3.785237331251534*^9, 3.785237368160993*^9}, {
   3.785237494514159*^9, 3.785237505004903*^9}, {3.7852375635429773`*^9, 
   3.785237573737165*^9}, {3.7852377799759903`*^9, 3.7852377858905687`*^9}, {
   3.785241328583473*^9, 3.785241339781232*^9}, 3.785241428934774*^9, {
   3.785241490835868*^9, 3.785241491124919*^9}, {3.785258554193006*^9, 
   3.7852585860296783`*^9}, {3.785260290240576*^9, 3.785260308254655*^9}, 
   3.785434219148193*^9},
 CellLabel->"In[70]:=",ExpressionUUID->"a8fa40c4-1c78-4ea5-9b0f-bcf5b5c1a773"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   StyleBox[
    RowBox[{
    "Uncomment", " ", "this", " ", "table", " ", "if", " ", "you", " ", 
     "want", " ", "to", " ", "see", " ", "the", " ", "density", " ", "plots", 
     " ", "of", " ", "the", " ", "eigenfunctions"}], "Text"], ";"}],
  FontWeight->"Bold"]], "Input",
 CellChangeTimes->{{3.785258609681336*^9, 3.7852586413406477`*^9}, {
  3.785260310797842*^9, 3.785260312695166*^9}, {3.7852612237429667`*^9, 
  3.785261226567746*^9}},ExpressionUUID->"142f31d6-a89e-41f5-8ed1-\
b3b4dfafb7c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"ParallelTable", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"DensityPlot", "[", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"modeN", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Floor", "[", "size", "]"}], "+", "1", "-", "j"}], 
                ",", "x", ",", "y"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{"modeN", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Floor", "[", "size", "]"}], "+", "1", "-", "j"}], 
                ",", "x", ",", "y"}], "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], "2"]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "reg"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
          RowBox[{"ColorFunction", "\[Rule]", "\"\<SunsetColors\>\""}], ",", 
          RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], ",", 
        RowBox[{"DensityPlot", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"modeN", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Floor", "[", "size", "]"}], "+", "1", "-", "j"}], 
               ",", "x", ",", "y"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "2"], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "reg"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
          RowBox[{"ColorFunction", "\[Rule]", "\"\<SunsetColors\>\""}], ",", 
          RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}], ",", 
        RowBox[{"DensityPlot", "[", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"Abs", "[", 
            RowBox[{
             RowBox[{"modeN", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Floor", "[", "size", "]"}], "+", "1", "-", "j"}], 
               ",", "x", ",", "y"}], "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}], "2"], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], "\[Element]", "reg"}], ",", 
          RowBox[{"ImageSize", "\[Rule]", "Large"}], ",", 
          RowBox[{"ColorFunction", "\[Rule]", "\"\<SunsetColors\>\""}], ",", 
          RowBox[{"PlotPoints", "\[Rule]", "100"}]}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "size"}], "}"}], ",", 
      RowBox[{"Method", "\[Rule]", "\"\<CoarsestGrained\>\""}], ",", 
      RowBox[{"DistributedContexts", "\[Rule]", "Automatic"}]}], "]"}], "//", 
    "AbsoluteTiming"}], "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.785258609681336*^9, 3.7852586413406477`*^9}, {
  3.785260310797842*^9, 3.785260312695166*^9}, {3.7852612237429667`*^9, 
  3.785261226567746*^9}, {3.785434248764893*^9, 
  3.785434249974399*^9}},ExpressionUUID->"af5f3f0c-8e44-4120-befa-\
b71840083c5a"]
},
WindowSize->{1366, 744},
WindowMargins->{{0, Automatic}, {1, Automatic}},
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 514, 10, 105, "Input",ExpressionUUID->"fb8e752b-9328-4db8-96b4-2d48ec51f856"],
Cell[1075, 32, 420, 10, 34, "Input",ExpressionUUID->"519beb74-def1-46f1-80e1-cae1fd945658"],
Cell[1498, 44, 886, 22, 147, "Input",ExpressionUUID->"951033f6-d344-4ea3-b80f-ea908db2a50f"],
Cell[2387, 68, 1246, 41, 34, "Input",ExpressionUUID->"b7acc9f9-f25a-408c-bebd-251042706f15"],
Cell[3636, 111, 1313, 34, 201, "Input",ExpressionUUID->"b66c53cb-f962-4987-8863-3afd3d75aa9b"],
Cell[4952, 147, 754, 15, 34, "Input",ExpressionUUID->"a1bd13b8-dd7d-4e52-8cbf-1c9cdd92b143"],
Cell[5709, 164, 1373, 28, 204, "Input",ExpressionUUID->"5452c035-7b03-4be5-9cf2-83a401ece3dc"],
Cell[7085, 194, 893, 24, 55, "Input",ExpressionUUID->"067d5e9f-1210-4493-a2b3-58bb44696a25"],
Cell[7981, 220, 1423, 38, 99, "Input",ExpressionUUID->"ba5f509b-9c46-4ba8-b3d6-c9ae274610fd"],
Cell[9407, 260, 697, 21, 31, "Input",ExpressionUUID->"ccb35278-6677-4fff-b66f-621be0e79bfa"],
Cell[10107, 283, 11359, 312, 740, "Input",ExpressionUUID->"8f88d0a3-a0e8-44e9-8e7c-86d0640a2fac"],
Cell[21469, 597, 542, 12, 34, "Input",ExpressionUUID->"3ff692bd-7b5f-4ce0-9d11-a48c23067cda"],
Cell[22014, 611, 6196, 194, 400, "Input",ExpressionUUID->"918f50e8-50c3-4b79-bb1f-e78b9ff0b347"],
Cell[28213, 807, 1231, 34, 55, "Input",ExpressionUUID->"a733a13d-861e-44ed-84f1-9ba32eb31045"],
Cell[29447, 843, 10299, 271, 750, "Input",ExpressionUUID->"1350be2a-d688-4bf9-a263-45943594805a"],
Cell[39749, 1116, 1445, 42, 78, "Input",ExpressionUUID->"7c13dc57-460f-46e1-87a6-9ffa1d4d0d1d"],
Cell[41197, 1160, 2121, 54, 124, "Input",ExpressionUUID->"20adb904-f5da-475f-b421-f0c293bec05e"],
Cell[43321, 1216, 4245, 87, 55, "Input",ExpressionUUID->"cfc621a4-70b5-4860-b6e1-6eb13c8ca592"],
Cell[47569, 1305, 7492, 169, 423, "Input",ExpressionUUID->"4c8bc942-ff59-4901-aa5a-b7da44c8835a"],
Cell[55064, 1476, 3081, 47, 34, "Input",ExpressionUUID->"a94ffc03-4ce5-44b9-ad6c-51980a746ffe"],
Cell[58148, 1525, 3525, 57, 147, "Input",ExpressionUUID->"438bd73c-4649-49b3-95a9-7c91dde8d978"],
Cell[61676, 1584, 315, 8, 34, "Input",ExpressionUUID->"72576364-7689-48fd-9daa-acf25d5191e3"],
Cell[61994, 1594, 900, 23, 91, "Input",ExpressionUUID->"4a99885c-7290-4c62-a783-e6b98ce1853e"],
Cell[62897, 1619, 431, 11, 31, "Input",ExpressionUUID->"f1403115-c119-4ca2-8c7e-3a071d99b407"],
Cell[63331, 1632, 1382, 35, 164, "Input",ExpressionUUID->"cb6a44ab-92b7-4ee1-9482-2e7a55215e8a"],
Cell[64716, 1669, 706, 15, 31, "Input",ExpressionUUID->"442387ef-7edc-4d12-8030-2a3fedd767e6"],
Cell[65425, 1686, 1395, 33, 68, "Input",ExpressionUUID->"8c07614c-395a-4240-995b-7411e6957ada"],
Cell[66823, 1721, 1568, 29, 31, "Input",ExpressionUUID->"dade93fb-e65b-43dd-a80c-f30f9842394e"],
Cell[68394, 1752, 3272, 72, 249, "Input",ExpressionUUID->"a8fa40c4-1c78-4ea5-9b0f-bcf5b5c1a773"],
Cell[71669, 1826, 540, 12, 31, "Input",ExpressionUUID->"142f31d6-a89e-41f5-8ed1-b3b4dfafb7c4"],
Cell[72212, 1840, 3289, 78, 132, "Input",ExpressionUUID->"af5f3f0c-8e44-4120-befa-b71840083c5a"]
}
]
*)

